<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cib.cap4j.cfn.auditlog.dao.IPAuditlogDao">
	<resultMap id="auditlogVO_result" type="com.cib.cap4j.cfn.auditlog.vo.IPAuditlogVO">
        <id column="RZBH" property="rzbh" />
        <result column="CZBM" property="czbm" />
        <result column="CZKHJQIP" property="czkhjqip" />
        <result column="YWLXBM" property="ywlxbm" />
        <result column="RZLX" property="rzlx" />
        <result column="CZRZXX" property="czrzxx" />
        <result column="RZJB" property="rzjb" />
        <result column="RZJLSJ" property="rzjlsj" />
        <result column="JLZT" property="jlzt" />
        <result column="YHBH" property="yhbh" />
    </resultMap>
    
    <select id="findAllByPagenation" resultMap="auditlogVO_result" parameterType="java.util.Map">
	    	select i.*, s.yhmc username, u.jgmc unitname from ip_auditlog i
	    	 left join ip_staff s on i.yhbh= s.yhbh
	    	 left join ip_unit u on s.ssjg = u.zj
	    	 where i.jlzt=1 
	    	<if test="czkhjqip != null and czkhjqip !=''">  and i.czkhjqip like ${czkhjqip}</if>
	    	<if test="czrzxx != null and czrzxx !=''">  and i.czrzxx like ${czrzxx}</if>
	     	<if test="username != null and username !=''">  and s.yhmc like ${username}</if>
	     	<if test="begin != null">   and i.rzjlsj <![CDATA[>=]]> #{begin}</if>
	     	<if test="end != null">  and i.rzjlsj  <![CDATA[<=]]>#{end}</if>
	     	order by i.rzjlsj desc
    </select>
 		
	 <select id="countAll" resultType="int" parameterType="java.util.Map">
		select count(*) from 
		(
			select 0 from ip_auditlog i
	    	 left join ip_staff s on i.yhbh= s.yhbh
	    	 left join ip_unit u on s.ssjg = u.zj
	    	 where i.jlzt=1 
	    	<if test="czkhjqip != null and czkhjqip !=''">  and i.czkhjqip like ${czkhjqip}</if>
	    	<if test="czrzxx != null and czrzxx !=''">  and i.czrzxx like ${czrzxx}</if>
	     	<if test="username != null and username !=''">  and s.yhmc like ${username}</if>
	     	<if test="begin != null">   and i.rzjlsj <![CDATA[>=]]> #{begin}</if>
	     	<if test="end != null">  and i.rzjlsj  <![CDATA[<=]]>#{end}</if>
		) t
     </select>
</mapper>	
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cib.cap4j.v3.cfn.recycle.dao.IRecycleDao">
<!-- 	分页查询记录状态为0的记录 -->
    <select id="findRecycleRecord" resultType="java.util.HashMap" parameterType="java.util.HashMap">
        select 
        <foreach item="field" index="index" collection="fieldList" separator=",">
        	<if test="field=='zhxgr' or field=='ZHXGR'">
        		s.yhmc ZHXGR
        	</if>
        	<if test="field!='zhxgr' and field!='ZHXGR'">
        		a.${field}
        	</if>
        </foreach> 
        from  ${tableName} a
        <if test="hasZhxgr==1">
        	left join ip_staff s on a.zhxgr = s.yhbh
        </if>
			where a.JLZT = '0'
			<if test="conditions != null">
	     		<foreach item="condition" index="index" collection="conditions">
	     			<if test="condition != null and condition.col != null and condition.col != '' and condition.value !=null and condition.value != ''">
				     	<if test="condition.col=='zhxgr' or condition.col=='ZHXGR'">
			        		and s.yhmc like ${condition.value}
			        	</if>
			        	<if test="condition.col!='zhxgr' and condition.col!='ZHXGR'">
							and a.${condition.col} like ${condition.value}
			        	</if>
					</if>
				</foreach>
			</if>
    </select>
    
    <select id="countRecycleRecord" resultType="int" parameterType="java.util.HashMap">
        select count(*) from  ${tableName}
			where JLZT = '0'
			<if test="conditions != null">
	     		<foreach item="condition" index="index" collection="conditions">
	     			<if test="condition != null and condition.col != null and condition.col != '' and condition.value !=null and condition.value != ''">
						and ${condition.col} like ${condition.value}
					</if>
				</foreach>
			</if>
    </select>
    
    <update id="update" parameterType="java.util.HashMap">
        update ${tableName} set JLZT = '1'
			where ${col} = #{zj}
    </update>
    
    <delete id="delete" parameterType="java.util.HashMap">
        delete from ${tableName} where ${col} = #{zj}
    </delete>
</mapper>		
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cib.cap4j.cfn.unit.dao.IPUnitCIDao">
		<resultMap id="ipUnitCIVO_result" type="com.cib.cap4j.cfn.unit.vo.IPUnitCIVO">
        <id column="ZJ" property="zj" />
        <result column="FRDH" property="frdh" />
        <result column="JGBH" property="jgbh" />
        <result column="JGQC" property="jgqc" />
        <result column="JGMC" property="jgmc" />
        <result column="JGDL" property="jgdl" />
        <result column="JGLX" property="jglx" />
        <result column="LSZXBS" property="lszxbs" />
        <result column="TCBS" property="tcbs" />
        <result column="YWTXLX" property="ywtxlx" />
        <result column="JGZZ" property="jgzz" />
        <result column="CLRQ" property="clrq" />
        <result column="PZCLWH" property="pzclwh" />
        <result column="CXRQ" property="cxrq" />
        <result column="PZCXWH" property="pzcxwh" />
        <result column="JGLXDZ" property="jglxdz" />
        <result column="LXRMC" property="lxrmc" />
        <result column="JGLXDH" property="jglxdh" />
        <result column="JRXKZH" property="jrxkzh" />
        <result column="XZSJGLJGBH" property="xzsjgljgbh" />
        <result column="TXSJGLJGBH" property="txsjgljgbh" />
        <result column="HXXTJGBS" property="hxxtjgbs" />
        <result column="JZJGBS" property="jzjgbs" />
        <result column="ZWSJGLJGBH" property="zwsjgljgbh" />
        <result column="ZFXXH" property="zfxxh" />
        <result column="JGZT" property="jgzt" />
        <result column="JRJGJB" property="jrjgjb" />
        <result column="GJDQBM" property="gjdqbm" />
        <result column="SQBM" property="sqbm" />
        <result column="SQBM1" property="sqbm1" />
        <result column="XQBM" property="xqbm" />
        <result column="ZSDQ" property="zsdq" />
        <result column="JRJGBM" property="jrjgbm" />
        <result column="SJJRJG" property="sjjrjg" />
        <result column="ZSJRJG" property="zsjrjg" />
        <result column="XZCXLJ" property="xzcxlj" />
        <result column="CWCXLJ" property="cwcxlj" />
        <result column="TXCXLJ" property="txcxlj" />
        <result column="ZT" property="zt" />
        <result column="JLZT" property="jlzt" />
        <result column="KZZD1" property="kzzd1" />
        <result column="KZZD2" property="kzzd2" />
        <result column="KZZD3" property="kzzd3" />
        <result column="KZZD4" property="kzzd4" />
        <result column="KZZD5" property="kzzd5" />
        <result column="KZZD6" property="kzzd6" />
        <result column="KZZD7" property="kzzd7" />
        <result column="KZZD8" property="kzzd8" />
        <result column="KZZD9" property="kzzd9" />
        <result column="KZZD10" property="kzzd10" />
        <result column="CZR" property="czr" />
        <result column="CZSJ" property="czsj" />
        <result column="CZLX" property="czlx" />
        <result column="JGZJ" property="jgzj" />
    </resultMap>
    <select id="findAll" resultMap="ipUnitCIVO_result" parameterType="com.cib.cap4j.cfn.unit.vo.IPUnitCIVO">
		 SELECT U.*, S.YHMC AS CZRXM, F.YHMC AS FHRXM 
		   FROM IP_STAFF F RIGHT JOIN IP_UNIT_CI U ON F.YHBH=U.FHRY
		   LEFT JOIN IP_STAFF S
		     ON U.CZR = S.YHBH
		  WHERE 1 = 1 
		  <if test = "zj != null and zj != ''" >  and U.XZCXLJ like ${zj} </if >
		  <if test = "jgmc != null and jgmc != ''" >  and U.JGMC like ${jgmc} </if >
		  <if test = "czrxm != null and czrxm != ''" >  and S.YHMC like ${czrxm} </if >
		  <if test = "czlx != null and czlx !=''" >  and U.CZLX like ${czlx} </if >
		  ORDER BY U.CZSJ DESC
    </select>
    <select id="findAllCount" resultType="java.lang.Integer" parameterType="com.cib.cap4j.cfn.unit.vo.IPUnitCIVO">
		 SELECT COUNT(*)
		   FROM IP_UNIT_CI U
		   LEFT JOIN IP_STAFF S
		     ON U.CZR = S.YHBH
		  WHERE 1 = 1 
		  <if test = "zj != null and zj != ''" >  and U.XZCXLJ like ${zj} </if >
		  <if test = "jgmc != null and jgmc != ''" >  and U.JGMC like ${jgmc} </if >
		  <if test = "czrxm != null and czrxm != ''" >  and S.YHMC like ${czrxm} </if >
		  <if test = "czlx != null and czlx !=''" >  and U.CZLX like ${czlx} </if >
    </select>
    
    <update id="updateFhzt" parameterType="com.cib.cap4j.cfn.unit.vo.IPUnitCIVO">
    	UPDATE IP_UNIT_CI
     	<set>
     		FHZT = #{fhzt},
     		FHRY = #{fhry},
     	    FHSJ = #{fhsj}
     	</set>
     	WHERE ZJ = #{zj}
    </update>
    
     <select id="countUnverified" resultType="int" parameterType="java.lang.String">
     	SELECT COUNT(*) FROM IP_UNIT_CI WHERE JGZJ = #{_parameter} AND FHZT = '0'
     </select>
          
     <select id="findUnitCIByZj" resultType="com.cib.cap4j.cfn.unit.vo.IPUnitCIVO" parameterType="java.lang.String">
     	SELECT * FROM IP_UNIT_CI WHERE ZJ = #{ZJ} 
     </select>
     
     <select id="findNotFHCount" resultType="int" parameterType="java.lang.String">
     	SELECT COUNT(*) FROM IP_UNIT_CI WHERE  FHZT = #{FHZT}
     </select>
</mapper>
